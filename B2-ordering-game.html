<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>INTUITY - Sentence Sequencing</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&family=Crimson+Text:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'DM Sans', 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: #0d0d0d;
      color: white;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }

    .background {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at 30% 20%, rgba(201, 169, 97, 0.18) 0%, transparent 40%),
                  radial-gradient(circle at 70% 80%, rgba(201, 169, 97, 0.16) 0%, transparent 38%),
                  radial-gradient(circle at 20% 70%, rgba(201, 169, 97, 0.12) 0%, transparent 45%),
                  radial-gradient(circle at 85% 15%, rgba(201, 169, 97, 0.14) 0%, transparent 35%),
                  #0d0d0d;
      z-index: 0; overflow: hidden;
    }

    .elegant-curves { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    .curve-elegant { position: absolute; border-radius: 50%; filter: blur(2px); }

    .curve-elegant-1 {
      width: 500px; height: 900px; top: -300px; right: -150px;
      border: 3px solid rgba(201, 169, 97, 0.35);
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.15) 0%, rgba(201, 169, 97, 0.08) 50%, transparent 100%);
      transform: rotate(25deg); animation: floatElegant 12s ease-in-out infinite;
      box-shadow: inset 0 0 60px rgba(201, 169, 97, 0.1), 0 0 80px rgba(201, 169, 97, 0.15);
    }
    .curve-elegant-2 {
      width: 600px; height: 1100px; bottom: -400px; left: -200px;
      border: 2.5px solid rgba(201, 169, 97, 0.32);
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.12) 0%, rgba(201, 169, 97, 0.06) 40%, transparent 80%);
      transform: rotate(-20deg); animation: floatElegant 15s ease-in-out infinite reverse;
      box-shadow: inset 0 0 50px rgba(201, 169, 97, 0.08), 0 0 70px rgba(201, 169, 97, 0.12);
    }
    .curve-elegant-3 {
      width: 400px; height: 750px; top: 25%; right: -50px;
      border: 2px solid rgba(201, 169, 97, 0.28);
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.10) 0%, rgba(201, 169, 97, 0.05) 50%, transparent 90%);
      transform: rotate(45deg); animation: driftElegant 18s ease-in-out infinite;
    }
    .curve-elegant-4 {
      width: 450px; height: 850px; top: 50%; left: -100px;
      border: 2.5px solid rgba(201, 169, 97, 0.30);
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.11) 0%, transparent 70%);
      transform: rotate(-35deg); animation: pulseElegant 20s ease-in-out infinite;
    }

    @keyframes floatElegant {
      0%, 100% { transform: translateY(0) rotate(var(--base-rotation, 0deg)); opacity: 1; }
      50% { transform: translateY(-30px) rotate(calc(var(--base-rotation, 0deg) + 3deg)); opacity: 0.85; }
    }
    @keyframes driftElegant {
      0%, 100% { transform: translate(0, 0) rotate(45deg); opacity: 1; }
      33% { transform: translate(20px, -25px) rotate(48deg); opacity: 0.9; }
      66% { transform: translate(-10px, -15px) rotate(42deg); opacity: 0.95; }
    }
    @keyframes pulseElegant {
      0%, 100% { transform: translate(0, 0) scale(1) rotate(-35deg); opacity: 1; }
      50% { transform: translate(-15px, 10px) scale(1.05) rotate(-33deg); opacity: 0.9; }
    }
    .curve-elegant-1 { --base-rotation: 25deg; }
    .curve-elegant-2 { --base-rotation: -20deg; }

    body::before {
      content: '';
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' /%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.01'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 1;
    }

    .container { max-width: 900px; margin: 0 auto; position: relative; z-index: 2; padding: 0 1rem; }

    .back-btn {
      position: fixed; top: 1.5rem; left: 1.5rem;
      padding: 0.625rem 1.25rem;
      background: rgba(28, 28, 30, 0.9);
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(84, 84, 88, 0.3);
      border-radius: 999px; color: #C9A961;
      font-size: 0.75rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.08em;
      cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
      z-index: 1000; display: flex; align-items: center; gap: 0.5rem;
    }
    .back-btn:hover { background: rgba(28, 28, 30, 1); border-color: rgba(201, 169, 97, 0.5); transform: translateX(-3px); }

    .header { text-align: center; margin-bottom: 2.5rem; padding: 1.5rem 0 1rem; }
    .header h1 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 2.25rem; font-weight: 700; margin-bottom: 0.5rem; letter-spacing: -0.04em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #C9A961 0%, rgba(201, 169, 97, 0.8) 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .header .subtitle { font-size: 0.8125rem; color: #8e8e93; font-weight: 500; letter-spacing: 0.04em; text-transform: uppercase; }

    .game-screen { display: none; padding: 1rem; }
    .game-screen.active { display: block; }

    .game-container {
      background: rgba(28, 28, 30, 0.98);
      backdrop-filter: blur(60px) saturate(180%); -webkit-backdrop-filter: blur(60px) saturate(180%);
      border: 1px solid rgba(84, 84, 88, 0.4);
      border-radius: 1.5rem;
      padding: 1.25rem 1rem 1.5rem;
      max-width: 900px; margin: 0 auto;
      box-shadow: 0 25px 50px rgba(0,0,0,0.6), 0 8px 24px rgba(0, 0, 0, 0.4);
    }

    .game-title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1.0625rem; font-weight: 600; color: #C9A961;
      text-align: center; margin-bottom: 0.25rem; padding-bottom: 0.625rem;
      border-bottom: 1px solid rgba(84, 84, 88, 0.3);
      text-transform: uppercase; letter-spacing: 0.02em;
    }
    .game-hint {
      text-align: center; font-size: 0.95rem;
      color: #6b7280; margin-bottom: 1rem;
      font-weight: 500;
    }

    /* PARAGRAPH SECTIONS */
    .paragraphs-container {
      background: linear-gradient(180deg, rgba(15, 15, 17, 0.6) 0%, rgba(20, 20, 22, 0.5) 100%);
      border-radius: 1rem;
      border: 1px solid rgba(84, 84, 88, 0.25);
      padding: 0.625rem;
      margin-bottom: 1.25rem;
      max-height: 640px;
      overflow-y: auto;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .paragraph-section {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(84, 84, 88, 0.2);
      border-radius: 0.875rem;
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      transition: all 0.3s ease;
    }

    .paragraph-section:last-child { margin-bottom: 0; }

    .paragraph-header {
      display: flex;
      align-items: center;
      gap: 0.625rem;
      margin-bottom: 0.625rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(201, 169, 97, 0.2);
    }

    .paragraph-label {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.65rem;
      font-weight: 700;
      color: #C9A961;
      background: rgba(201, 169, 97, 0.15);
      padding: 0.25rem 0.625rem;
      border-radius: 999px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .paragraph-count {
      font-size: 0.7rem;
      color: #8e8e93;
      font-weight: 500;
    }

    /* FIXED ANCHOR SENTENCE */
    .fixed-sentence {
      background: linear-gradient(135deg, #D1B982 0%, #C4AB72 100%);
      border: 2px solid rgba(201, 169, 97, 0.4);
      border-radius: 0.75rem;
      padding: 0.625rem 0.875rem;
      margin-bottom: 0.5rem;
      display: flex;
      gap: 0.625rem;
      align-items: center;
      box-shadow: 0 3px 12px rgba(201, 169, 97, 0.2), 0 1px 4px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .fixed-sentence::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 4px;
      height: 100%;
      background: #B89650;
    }

    .fixed-sentence .sentence-label {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.6rem;
      font-weight: 700;
      color: #7a6530;
      background: rgba(201, 169, 97, 0.2);
      padding: 0.2rem 0.45rem;
      border-radius: 999px;
      text-align: center;
      min-width: 32px;
      flex-shrink: 0;
    }

    .fixed-sentence .sentence-text {
      flex: 1;
      font-family: 'Crimson Text', serif;
      font-size: 0.9rem;
      line-height: 1.35;
      color: #1c1c1e;
      font-weight: 700;
    }

    .fixed-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.5625rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #7a6530;
      background: rgba(201, 169, 97, 0.2);
      border: 1px solid rgba(201, 169, 97, 0.3);
      border-radius: 999px;
      padding: 0.175rem 0.5rem;
      flex-shrink: 0;
      white-space: nowrap;
    }

    .fixed-badge svg {
      width: 10px;
      height: 10px;
      fill: #7a6530;
    }

    /* DROP SLOTS */
    .drop-slots {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      min-height: 40px;
    }

    .drop-slot {
      min-height: 60px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
      border: 2px dashed rgba(201, 169, 97, 0.3);
      border-radius: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      position: relative;
    }

    .drop-slot.drag-over {
      background: rgba(201, 169, 97, 0.15);
      border-color: rgba(201, 169, 97, 0.6);
      border-style: solid;
      transform: scale(1.02);
    }

    .drop-slot-label {
      font-size: 0.7rem;
      color: #6b7280;
      font-weight: 500;
      pointer-events: none;
    }

    /* SENTENCE CARD IN SLOT */
    .sentence-card {
      background: linear-gradient(135deg, #F5F1E8 0%, #EBE6DC 100%);
      border: 2px solid transparent;
      border-radius: 0.75rem;
      padding: 0.5rem 0.75rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      gap: 0.625rem;
      align-items: center;
      cursor: grab;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.06);
      width: 100%;
    }

    .sentence-card:active {
      cursor: grabbing;
    }

    .sentence-card.dragging {
      opacity: 0.5;
      transform: rotate(2deg);
    }

    .sentence-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, #D4A574 0%, #C9A961 100%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .sentence-card:hover::before {
      opacity: 0.6;
    }

    .sentence-card .sentence-label {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.6rem;
      font-weight: 700;
      color: #7a6530;
      background: rgba(201, 169, 97, 0.2);
      padding: 0.2rem 0.45rem;
      border-radius: 999px;
      text-align: center;
      min-width: 32px;
      flex-shrink: 0;
    }

    .sentence-card .sentence-text {
      flex: 1;
      font-family: 'Crimson Text', serif;
      font-size: 0.9rem;
      line-height: 1.35;
      color: #1c1c1e;
      font-weight: 600;
    }

    .drag-handle {
      font-size: 1rem;
      color: #8e8e93;
      cursor: grab;
      user-select: none;
      flex-shrink: 0;
    }

    .drag-handle:active {
      cursor: grabbing;
    }

    /* CORRECT/INCORRECT STATES */
    .sentence-card.correct {
      border-color: #10b981 !important;
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important;
      box-shadow: 0 4px 16px rgba(16, 185, 129, 0.25);
    }

    .sentence-card.correct::before {
      background: #10b981;
      opacity: 1;
    }

    .sentence-card.incorrect {
      border-color: #ef4444 !important;
      background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
      box-shadow: 0 4px 16px rgba(239, 68, 68, 0.25);
    }

    .sentence-card.incorrect::before {
      background: #ef4444;
      opacity: 1;
    }

    /* AVAILABLE SENTENCES POOL */
    .available-sentences {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(84, 84, 88, 0.2);
      border-radius: 0.875rem;
      padding: 0.75rem;
      margin-bottom: 1.25rem;
    }

    .available-header {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      color: #C9A961;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.625rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(201, 169, 97, 0.2);
    }

    .available-pool {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      min-height: 60px;
    }

    .available-pool.empty {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
    }

    .empty-message {
      font-size: 0.8rem;
      color: #6b7280;
      font-weight: 500;
      text-align: center;
    }

    /* LINKING WORDS */
    .linking-word {
      color: #dc2626;
      font-weight: 700;
      padding: 0 0.125rem;
    }

    /* ACTION BAR */
    .game-actions {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 999px;
      padding: 0.35rem;
      max-width: fit-content;
      margin: 0 auto;
    }

    .game-btn {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.01em;
      padding: 0.5rem 1.125rem;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      white-space: nowrap;
    }

    .game-btn .btn-icon {
      font-size: 0.85rem;
      line-height: 1;
    }

    .btn-submit {
      background: #C9A961;
      color: #111;
      font-weight: 700;
      box-shadow: 0 2px 10px rgba(201, 169, 97, 0.35);
    }

    .btn-submit:hover:not(:disabled) {
      background: #d4b46e;
      box-shadow: 0 4px 18px rgba(201, 169, 97, 0.5);
      transform: scale(1.04);
    }

    .btn-submit:active:not(:disabled) {
      transform: scale(0.97);
    }

    .btn-submit:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .btn-retry {
      background: rgba(255, 255, 255, 0.08);
      color: #d4d4d8;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn-retry:hover {
      background: rgba(255, 255, 255, 0.14);
      color: #fff;
      transform: scale(1.04);
    }

    .btn-new {
      background: rgba(255, 255, 255, 0.05);
      color: #8e8e93;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .btn-new:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #C9A961;
      transform: scale(1.04);
    }

    .btn-answers {
      background: rgba(99, 140, 255, 0.1);
      color: #7ba4ff;
      border: 1px solid rgba(99, 140, 255, 0.15);
    }

    .btn-answers:hover {
      background: rgba(99, 140, 255, 0.18);
      color: #a0bfff;
      transform: scale(1.04);
    }

    .btn-answers.showing-answers {
      background: rgba(99, 140, 255, 0.22);
      color: #fff;
      border-color: rgba(99, 140, 255, 0.3);
    }

    /* ANSWER KEY */
    .answer-key-display {
      display: none;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.12) 0%, rgba(37, 99, 235, 0.08) 100%);
      border: 2px solid rgba(59, 130, 246, 0.4);
      border-radius: 1.125rem;
      margin-bottom: 1.5rem;
      overflow: hidden;
    }

    .answer-key-display.show {
      display: block;
      animation: slideIn 0.4s ease-out;
    }

    .answer-key-header {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(37, 99, 235, 0.15) 100%);
      padding: 1rem 1.25rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(59, 130, 246, 0.3);
    }

    .answer-key-title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      color: #3b82f6;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .close-answers {
      background: rgba(59, 130, 246, 0.15);
      border: 1px solid rgba(59, 130, 246, 0.3);
      color: #3b82f6;
      font-size: 1.25rem;
      font-weight: 700;
      width: 32px;
      height: 32px;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .close-answers:hover {
      background: rgba(59, 130, 246, 0.25);
      transform: scale(1.1);
    }

    .answer-key-content {
      padding: 1.25rem;
      max-height: 400px;
      overflow-y: auto;
    }

    .answer-paragraph {
      margin-bottom: 1.5rem;
    }

    .answer-paragraph:last-child {
      margin-bottom: 0;
    }

    .answer-para-label {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.7rem;
      font-weight: 700;
      color: #3b82f6;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .answer-sentence {
      display: flex;
      gap: 0.875rem;
      align-items: flex-start;
      padding: 0.75rem 1rem;
      margin-bottom: 0.5rem;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 0.75rem;
      border-left: 4px solid #3b82f6;
    }

    .answer-sentence:last-child {
      margin-bottom: 0;
    }

    .answer-sentence.answer-fixed {
      background: rgba(201, 169, 97, 0.15);
      border-left: 4px solid #C9A961;
    }

    .answer-number {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1.125rem;
      font-weight: 800;
      min-width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .answer-sentence.answer-fixed .answer-number {
      background: linear-gradient(135deg, #C9A961 0%, #B89650 100%);
      color: #1a1a2e;
    }

    .answer-text {
      flex: 1;
      font-family: 'Crimson Text', serif;
      font-size: 0.95rem;
      line-height: 1.5;
      color: #1c1c1e;
      font-weight: 600;
    }

    /* RESULTS */
    .results-display {
      display: none;
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.15) 0%, rgba(201, 169, 97, 0.1) 100%);
      border: 2px solid rgba(201, 169, 97, 0.5);
      border-radius: 1.125rem;
      padding: 1.75rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .results-display.show {
      display: block;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .results-score {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 2.75rem;
      font-weight: 800;
      color: #C9A961;
      margin-bottom: 0.625rem;
    }

    .results-message {
      font-size: 1.0625rem;
      color: #f5f5f7;
      font-weight: 500;
    }

    .perfect-score {
      color: #10b981;
    }

    /* SCROLLBAR */
    .paragraphs-container::-webkit-scrollbar,
    .answer-key-content::-webkit-scrollbar {
      width: 8px;
    }

    .paragraphs-container::-webkit-scrollbar-track,
    .answer-key-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }

    .paragraphs-container::-webkit-scrollbar-thumb,
    .answer-key-content::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, #C9A961 0%, #B89650 50%);
      border-radius: 4px;
    }

    @media (max-width: 768px) {
      .back-btn {
        top: 1rem;
        left: 1rem;
        padding: 0.5rem 1rem;
        font-size: 0.65rem;
      }

      .sentence-card,
      .fixed-sentence {
        padding: 0.75rem 0.875rem;
      }

      .game-btn {
        padding: 0.45rem 0.875rem;
        font-size: 0.65rem;
      }
    }
  </style>
</head>
<body>
  <div class="background">
    <div class="elegant-curves">
      <div class="curve-elegant curve-elegant-1"></div>
      <div class="curve-elegant curve-elegant-2"></div>
      <div class="curve-elegant curve-elegant-3"></div>
      <div class="curve-elegant curve-elegant-4"></div>
    </div>
  </div>

  <button class="back-btn" onclick="goBack()"><span>‚Üê</span><span>Back</span></button>

  <div class="container">
    <header class="header">
      <h1>INTUITY</h1>
      <p class="subtitle">Sentence Sequencing Challenge</p>
    </header>

    <div class="game-screen active" id="gameScreen">
      <div class="game-container">
        <h2 class="game-title" id="gameTitle"></h2>
        <p class="game-hint">Drag sentences into the correct order within each paragraph</p>

        <div class="available-sentences">
          <div class="available-header">üì¶ Available Sentences</div>
          <div class="available-pool" id="availablePool"></div>
        </div>

        <div class="paragraphs-container" id="paragraphsContainer"></div>

        <div class="answer-key-display" id="answerKeyDisplay">
          <div class="answer-key-header">
            <span class="answer-key-title">‚úì Correct Sequence</span>
            <button class="close-answers" onclick="toggleAnswers()">‚úï</button>
          </div>
          <div class="answer-key-content" id="answerKeyContent"></div>
        </div>

        <div class="results-display" id="resultsDisplay">
          <div class="results-score" id="resultsScore">0%</div>
          <div class="results-message" id="resultsMessage">Keep trying!</div>
        </div>

        <div class="game-actions">
          <button class="game-btn btn-submit" id="submitBtn" onclick="checkAnswer()"><span class="btn-icon">‚úì</span> Check</button>
          <button class="game-btn btn-retry" id="retryBtn" onclick="retry()" style="display:none;"><span class="btn-icon">‚Üª</span> Retry</button>
          <button class="game-btn btn-answers" id="answersBtn" onclick="toggleAnswers()" style="display:none;"><span class="btn-icon">üëÅ</span> Answers</button>
          <button class="game-btn btn-new" onclick="newGame()"><span class="btn-icon">‚ü≥</span> New</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentData = null;
    let currentSample = null;
    let paragraphsData = [];
    let draggedElement = null;
    let hasSubmitted = false;
    let showingAnswers = false;

    const LINKING_WORDS = [
      'however', 'therefore', 'moreover', 'furthermore', 'additionally', 'consequently',
      'meanwhile', 'nevertheless', 'nonetheless', 'thus', 'hence', 'accordingly',
      'besides', 'likewise', 'similarly', 'conversely', 'alternatively', 'specifically',
      'indeed', 'subsequently', 'finally', 'firstly', 'secondly', 'thirdly', 'lastly',
      'in addition', 'in contrast', 'for example', 'for instance', 'as a result',
      'on the other hand', 'in conclusion', 'to sum up', 'in summary', 'in brief',
      'in short', 'overall', 'essentially', 'basically', 'what is more',
      'to begin with', 'to start with', 'by far', 'it is generally agreed',
      'it was generally felt', 'one positive aspect', 'one major concern',
      'this is because', 'this is mainly due to', 'as a consequence', 'what makes', 'what made'
    ];

    const urlParams = new URLSearchParams(window.location.search);
    const contentType = urlParams.get('type') || 'essays';
    
    // Data paths - adjust based on actual file structure
    const DATA_PATHS = {
      essays: 'data/essays-models.json',
      reports: 'data/reports-models.json',
      reviews: 'data/reviews-models.json',
      emails: 'data/emails-models.json'
    };

    function goBack() {
      window.location.href = 'index.html';
    }

    window.addEventListener('DOMContentLoaded', () => startGame(contentType));

    async function startGame(type) {
      try {
        const response = await fetch(DATA_PATHS[type]);
        if (!response.ok) throw new Error(`Failed to load ${type}`);
        currentData = await response.json();
        currentSample = currentData.samples[Math.floor(Math.random() * currentData.samples.length)];
        extractParagraphs();
        document.getElementById('gameTitle').textContent = currentSample.topic || 'Sentence Sequencing Challenge';
        renderGame();
      } catch (e) {
        console.error(e);
        alert('Failed to load game data.');
      }
    }

    function extractParagraphs() {
      paragraphsData = [];
      let globalIndex = 0;

      currentSample.paragraphs.forEach((para, paraIdx) => {
        const sentences = para.text
          .split(/(?<=[.!?])\s+/)
          .filter(s => s.trim())
          .map(s => s.trim());

        const paraData = {
          label: para.label,
          sentences: [],
          fixedSentence: null
        };

        sentences.forEach((text, sentIdx) => {
          const sentenceObj = {
            text,
            globalIndex,
            isFixed: sentIdx === 0,
            correctSlot: sentIdx
          };

          if (sentIdx === 0) {
                paraData.fixedSentence = sentenceObj;
          } else {
            paraData.sentences.push(sentenceObj);
          }

          globalIndex++;
        });

        paragraphsData.push(paraData);
      });
    }

    function highlightLinkingWords(text) {
      let result = text;
      LINKING_WORDS.forEach(word => {
        const regex = new RegExp(`\\b(${word})\\b`, 'gi');
        result = result.replace(regex, '<span class="linking-word">$1</span>');
      });
      return result;
    }

    function renderGame() {
      hasSubmitted = false;
      document.getElementById('resultsDisplay').classList.remove('show');
      document.getElementById('submitBtn').style.display = 'inline-flex';
      document.getElementById('retryBtn').style.display = 'none';
      document.getElementById('answersBtn').style.display = 'none';
      document.getElementById('answerKeyDisplay').classList.remove('show');
      showingAnswers = false;

      renderParagraphs();
      renderAvailablePool();
    }

    function renderParagraphs() {
      const container = document.getElementById('paragraphsContainer');
      container.innerHTML = '';

      paragraphsData.forEach((para, paraIdx) => {
        const section = document.createElement('div');
        section.className = 'paragraph-section';
        section.dataset.paraIndex = paraIdx;

        const header = document.createElement('div');
        header.className = 'paragraph-header';
        header.innerHTML = `
          <div class="paragraph-label">${para.label}</div>
          <div class="paragraph-count">${para.sentences.length + 1} sentences</div>
        `;
        section.appendChild(header);

        // Fixed sentence
        const fixedDiv = document.createElement('div');
        fixedDiv.className = 'fixed-sentence';
        fixedDiv.innerHTML = `
          <div class="sentence-label">S${para.fixedSentence.globalIndex + 1}</div>
          <div class="sentence-text">${highlightLinkingWords(para.fixedSentence.text)}</div>
          <div class="fixed-badge">
            <svg viewBox="0 0 16 16"><path d="M11.5 1a3.5 3.5 0 0 0-3.5 3.5V7H4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H9.5V4.5a2 2 0 1 1 4 0V6h1.5V4.5A3.5 3.5 0 0 0 11.5 1z"/></svg>
            <span>Anchor</span>
          </div>
        `;
        section.appendChild(fixedDiv);

        // Drop slots
        const slotsDiv = document.createElement('div');
        slotsDiv.className = 'drop-slots';
        
        para.sentences.forEach((_, slotIdx) => {
          const slot = document.createElement('div');
          slot.className = 'drop-slot';
          slot.dataset.paraIndex = paraIdx;
          slot.dataset.slotIndex = slotIdx;
          slot.innerHTML = `<div class="drop-slot-label">Drop sentence here</div>`;
          
          slot.addEventListener('dragover', handleDragOver);
          slot.addEventListener('dragleave', handleDragLeave);
          slot.addEventListener('drop', handleDrop);
          
          slotsDiv.appendChild(slot);
        });

        section.appendChild(slotsDiv);
        container.appendChild(section);
      });
    }

    function renderAvailablePool() {
      const pool = document.getElementById('availablePool');
      pool.innerHTML = '';

      // Collect all movable sentences
      const allMovable = [];
      paragraphsData.forEach((para, paraIdx) => {
        para.sentences.forEach((sent) => {
          allMovable.push({ ...sent, paraIdx });
        });
      });

      // Shuffle
      shuffleArray(allMovable);

      if (allMovable.length === 0) {
        pool.classList.add('empty');
        pool.innerHTML = '<div class="empty-message">All sentences placed!</div>';
        return;
      }

      pool.classList.remove('empty');

      allMovable.forEach((sent) => {
        const card = createSentenceCard(sent);
        pool.appendChild(card);
      });
    }

    function createSentenceCard(sentenceObj) {
      const card = document.createElement('div');
      card.className = 'sentence-card';
      card.draggable = true;
      card.dataset.globalIndex = sentenceObj.globalIndex;
      card.dataset.paraIndex = sentenceObj.paraIdx;
      card.dataset.correctSlot = sentenceObj.correctSlot;

      card.innerHTML = `
        <div class="drag-handle">‚ãÆ‚ãÆ</div>
        <div class="sentence-label">S${sentenceObj.globalIndex + 1}</div>
        <div class="sentence-text">${highlightLinkingWords(sentenceObj.text)}</div>
      `;

      card.addEventListener('dragstart', handleDragStart);
      card.addEventListener('dragend', handleDragEnd);

      return card;
    }

    function handleDragStart(e) {
      draggedElement = e.currentTarget;
      e.currentTarget.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/html', e.currentTarget.innerHTML);
    }

    function handleDragEnd(e) {
      e.currentTarget.classList.remove('dragging');
    }

    function handleDragOver(e) {
      if (e.preventDefault) e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      
      const slot = e.currentTarget;
      if (slot.classList.contains('drop-slot') && !slot.querySelector('.sentence-card')) {
        slot.classList.add('drag-over');
      }
      
      return false;
    }

    function handleDragLeave(e) {
      e.currentTarget.classList.remove('drag-over');
    }

    function handleDrop(e) {
      if (e.stopPropagation) e.stopPropagation();
      e.preventDefault();

      const slot = e.currentTarget;
      slot.classList.remove('drag-over');

      if (!draggedElement) return;

      // Check if slot is empty
      if (slot.querySelector('.sentence-card')) {
        return false;
      }

      // Move card to slot
      const label = slot.querySelector('.drop-slot-label');
      if (label) label.remove();
      
      slot.appendChild(draggedElement);
      draggedElement = null;

      // Check if pool is empty
      updateAvailablePool();

      return false;
    }

    function updateAvailablePool() {
      const pool = document.getElementById('availablePool');
      const cards = pool.querySelectorAll('.sentence-card');
      
      if (cards.length === 0) {
        pool.classList.add('empty');
        pool.innerHTML = '<div class="empty-message">‚úì All sentences placed!</div>';
      }
    }

    // Allow cards to be dragged back to pool
    document.getElementById('availablePool').addEventListener('dragover', handleDragOver);
    document.getElementById('availablePool').addEventListener('drop', function(e) {
      if (e.stopPropagation) e.stopPropagation();
      e.preventDefault();

      if (!draggedElement) return;

      const pool = document.getElementById('availablePool');
      
      // Remove empty message if exists
      const emptyMsg = pool.querySelector('.empty-message');
      if (emptyMsg) {
        emptyMsg.remove();
        pool.classList.remove('empty');
      }

      // If card came from a slot, restore the drop zone
      const oldParent = draggedElement.parentElement;
      if (oldParent && oldParent.classList.contains('drop-slot')) {
        oldParent.innerHTML = '<div class="drop-slot-label">Drop sentence here</div>';
      }

      pool.appendChild(draggedElement);
      draggedElement = null;
    });

    function checkAnswer() {
      if (hasSubmitted) return;

      let totalSentences = 0;
      let correctCount = 0;

      paragraphsData.forEach((para, paraIdx) => {
        // Count fixed sentence as always correct
        totalSentences++;
        correctCount++;

        // Check movable sentences
        const slots = document.querySelectorAll(`.drop-slot[data-para-index="${paraIdx}"]`);
        
        slots.forEach((slot, slotIdx) => {
          totalSentences++;
          const card = slot.querySelector('.sentence-card');
          
          if (card) {
            const correctSlot = parseInt(card.dataset.correctSlot);
            const cardParaIdx = parseInt(card.dataset.paraIndex);
            
            if (cardParaIdx === paraIdx && correctSlot === (slotIdx + 1)) {
              card.classList.add('correct');
              correctCount++;
            } else {
              card.classList.add('incorrect');
            }
          }
        });
      });

      // Mark all fixed sentences as correct
      document.querySelectorAll('.fixed-sentence').forEach(fixed => {
        fixed.style.borderColor = '#10b981';
        fixed.style.boxShadow = '0 4px 16px rgba(16, 185, 129, 0.25)';
      });

      hasSubmitted = true;
      const percentage = Math.round((correctCount / totalSentences) * 100);
      showResults(percentage, correctCount, totalSentences);
    }

    function showResults(percentage, correct, total) {
      const scoreEl = document.getElementById('resultsScore');
      const messageEl = document.getElementById('resultsMessage');

      scoreEl.textContent = `${percentage}%`;

      if (percentage === 100) {
        scoreEl.className = 'results-score perfect-score';
        messageEl.textContent = 'üéâ Perfect! You mastered this text structure!';
      } else if (percentage >= 80) {
        scoreEl.className = 'results-score';
        messageEl.textContent = `Great job! ${correct} out of ${total} correct!`;
      } else if (percentage >= 60) {
        scoreEl.className = 'results-score';
        messageEl.textContent = `Good effort! ${correct} out of ${total} correct. Try again!`;
      } else {
        scoreEl.className = 'results-score';
        messageEl.textContent = `${correct} out of ${total} correct. Keep practicing!`;
      }

      document.getElementById('resultsDisplay').classList.add('show');
      document.getElementById('submitBtn').style.display = 'none';
      document.getElementById('retryBtn').style.display = 'inline-flex';
      document.getElementById('answersBtn').style.display = 'inline-flex';

      // Disable dragging after submission
      document.querySelectorAll('.sentence-card').forEach(card => {
        card.draggable = false;
        card.style.cursor = 'default';
      });
    }

    function retry() {
      hasSubmitted = false;
      showingAnswers = false;
      
      document.getElementById('answersBtn').innerHTML = '<span class="btn-icon">üëÅ</span> Answers';
      document.getElementById('answersBtn').classList.remove('showing-answers');
      document.getElementById('answersBtn').style.display = 'none';
      document.getElementById('answerKeyDisplay').classList.remove('show');
      
      // Reset fixed sentences styling
      document.querySelectorAll('.fixed-sentence').forEach(fixed => {
        fixed.style.borderColor = '';
        fixed.style.boxShadow = '';
      });
      
      renderGame();
    }

    function toggleAnswers() {
      const btn = document.getElementById('answersBtn');
      const display = document.getElementById('answerKeyDisplay');
      const content = document.getElementById('answerKeyContent');

      if (showingAnswers) {
        showingAnswers = false;
        btn.innerHTML = '<span class="btn-icon">üëÅ</span> Answers';
        btn.classList.remove('showing-answers');
        display.classList.remove('show');
      } else {
        showingAnswers = true;
        btn.innerHTML = '<span class="btn-icon">‚úï</span> Hide';
        btn.classList.add('showing-answers');
        
        content.innerHTML = '';
        
        paragraphsData.forEach((para) => {
          const paraDiv = document.createElement('div');
          paraDiv.className = 'answer-paragraph';
          
          const label = document.createElement('div');
          label.className = 'answer-para-label';
          label.textContent = para.label;
          paraDiv.appendChild(label);

          // Fixed sentence
          const fixedDiv = document.createElement('div');
          fixedDiv.className = 'answer-sentence answer-fixed';
          fixedDiv.innerHTML = `
            <div class="answer-number">${para.fixedSentence.globalIndex + 1}</div>
            <div class="answer-text">${highlightLinkingWords(para.fixedSentence.text)}</div>
          `;
          paraDiv.appendChild(fixedDiv);

          // Movable sentences in correct order
          para.sentences.forEach((sent) => {
            const sentDiv = document.createElement('div');
            sentDiv.className = 'answer-sentence';
            sentDiv.innerHTML = `
              <div class="answer-number">${sent.globalIndex + 1}</div>
              <div class="answer-text">${highlightLinkingWords(sent.text)}</div>
            `;
            paraDiv.appendChild(sentDiv);
          });

          content.appendChild(paraDiv);
        });

        display.classList.add('show');
      }
    }

    function newGame() {
      window.location.href = 'index.html';
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
  </script>
</body>
</html>
